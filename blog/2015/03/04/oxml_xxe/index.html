
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Exploiting XXE Vulnerabilities in OXML Documents - Part 1 - Silent Robot Systems</title>
  <meta name="author" content="Willis Vandevanter">

  
  <meta name="description" content="Exploiting XXE Vulnerabilities in OXML Documents - Part 1 OXML is a common document format; think docx (Microsoft Word Document), pptx (Microsoft &hellip;">
  

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href=" { { site.url } }{ { page.url } }" />
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/styles.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Silent Robot Systems" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script src="/javascripts/jquery.sidr.min.js"></script>
  <script src="/javascripts/ah-blue.js"></script>
  

  <script type="text/javascript">
      var host = "www.silentrobots.com";
      if ((host == window.location.host) && (window.location.protocol != "https:"))
          window.location.protocol = "https";
  </script>
</head> 

<body   >
  <div class="aux-container">
    <a id="nav-toggle" href="#sidr"></a>
    <a id="search-toggle"></a>
</div>

<!--
<header class="header-container clearfix">
        <a href="/"><img src="/images/srs_head.png" height=200 width=200 align=right></a>
</header>
-->


  <div class="main-container">
    <div class="main wrapper clearfix">
    	
    	<aside>
			
			  	<div class="search-container">
					<br>
					<center><a href="/"><img src="/images/srs_head.png" height=200 width=200></a></center>
					<br>
					<div id="main-nav">
    <nav>
        <ul>
        	<li>
        		
					<h3>Recent Posts</h3>
<ul>
	
    <li>
    	<a href="/blog/2016/04/30/exploiting-xxe-in-file-upload/">Exploiting XXE In File Upload Functionality</a>
    </li>
    
    <li>
    	<a href="/blog/2016/03/27/cloud_metadata_list/">Cloud Metadata URL List</a>
    </li>
    
    <li>
    	<a href="/blog/2015/12/14/xe-cheatsheet-update/">XML Entity Cheatsheet - Updated</a>
    </li>
    
    <li>
    	<a href="/blog/2015/09/10/blackhat-2015-arsenal/">Blackhat 2015 Arsenal</a>
    </li>
    
    <li>
    	<a href="/blog/2015/04/13/simple_ruby_exec/">Simple Ruby Exec with Open and Pipe</a>
    </li>
    
</ul>

				
        	</li>
        	<li>
        		<ul>
                    <li><a href="/about" target="_blank">About</a>
                    <li><a href="/projects" target="_blank">Projects</a>
        		</ul>
        	</li>
        	<li>
        		<ul>
        			<li>Github - <a href="http://www.github.com/BuffaloWill" target="_blank">github.com/BuffaloWill</a></li>
                    <li>Twitter - <a href="http://www.twitter.com/_will_is_" target="_blank">@_will_is_</a></li>
                    <li>Email - <a href="" target="_blank">will _at_ silentrobots.com</a></li>
        		</ul>
        	</li>
        </ul>
    </nav>
</div>

					<br><br><br>
				</div>
			
		</aside>
		
		<br><br><br><br>
      <div>
<article>
	<header>
  <div class="article-tags">
      


  </div>
  
    <h1>
      Exploiting XXE Vulnerabilities in OXML Documents - Part 1
    </h1>
  
</header>

  <section><p>OXML is a common document format; think docx (Microsoft Word Document), pptx (Microsoft Powerpoint), xlsx (Excel Spreadsheet), etc.</p>

<!-- more -->


<p>An OXML document is a zip file containing XML files and any media files. When the document is rendered, the rendering library unzips the document and then parses the containing XML files. The order the XML files are parsed and which files maintain precedence over the others is dependent on the type of document. The following link is from Microsoft on the XML structure in Office 2007 files: <a href="https://msdn.microsoft.com/en-us/library/aa338205%28v=office.12%29.aspx#office2007aboutnewfileformat_structureoftheofficexmlformats">File format structure</a></p>

<p>I have had success in the past embedding XML External Entities into the XML files of a docx, the XXE is exploited when the document is parsed. An easy example of this would be in file upload functionality that allows docx, pptx, or xlsx. Facebook was found vulnerable to this exact scenario in December 2014; <a href="http://threatpost.com/xxe-bug-patched-in-facebook-careers-third-party-service">XXE Bug Patched in Facebook</a>.</p>

<p>If you review the Microsoft link posted earlier you will see that each XML file plays a different role. I have found varying levels of success in which XML file I embed the XXE exploit into. To help out with this testing process I wrote a tool:</p>

<p><a href="https://github.com/BuffaloWill/oxml_xxe">https://github.com/BuffaloWill/oxml_xxe</a></p>

<p>Keeping with 300 words or less I will stop here and pick up with oxml_xxe usage in the next blog post.</p>
</section>



	
</article>
</div>

    </div>
  </div>
  


  

</body>
</html>
